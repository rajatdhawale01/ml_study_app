{% extends "layout.html" %}
{% block content %}
<!-- Hero -->
<section
  class="relative overflow-hidden rounded-2xl mb-6 border"
  style="background: radial-gradient(1200px 400px at 20% -10%, rgba(79,70,229,0.15), transparent),
                 radial-gradient(900px 300px at 90% 0%, rgba(236,72,153,0.12), transparent);">
  <div class="relative z-10 px-5 py-8 sm:px-8">
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
      <div>
        <h1 class="text-3xl font-bold tracking-tight">Machine Learning â€” Study Hub</h1>
        <p class="text-gray-600 mt-1 dark:text-gray-300">
          Explore the essentials: Intro Â· Process Â· Interactive Mind Map Â· Theory. Use search, shortcuts, or click a card.
        </p>
      </div>
      <div class="flex items-center gap-2">
        <!-- Theme toggle -->
        <button id="themeToggle"
          class="rounded-full border px-3 py-1.5 text-sm hover:shadow transition bg-white/70 backdrop-blur dark:bg-gray-900">
          <span class="inline dark:hidden">ğŸŒ™ Dark</span>
          <span class="hidden dark:inline">â˜€ï¸ Light</span>
        </button>
      </div>
    </div>

    <!-- Search -->
    <div class="mt-5">
      <div class="relative max-w-xl">
        <input id="searchInput" placeholder="Search sectionsâ€¦ (e.g., mind, theory)"
               class="w-full rounded-xl border px-4 py-2.5 pr-10 outline-none focus:ring-2 focus:ring-indigo-400
                      bg-white/80 backdrop-blur dark:bg-gray-900 dark:border-gray-700 dark:placeholder-gray-400" />
        <div class="pointer-events-none absolute inset-y-0 right-3 flex items-center text-gray-400">âŒ˜K</div>
      </div>
      <p class="text-xs text-gray-500 mt-2">
        Tips: Press <span class="font-medium">âŒ˜/Ctrl + K</span> to focus search â€¢ Press <span class="font-medium">1-9</span> to open a card
      </p>
    </div>
  </div>

  <!-- Decorative blur orbs -->
  <div class="absolute -top-16 -left-10 h-40 w-40 rounded-full blur-3xl opacity-50"
       style="background: linear-gradient(120deg, rgba(99,102,241,0.35), rgba(236,72,153,0.35));"></div>
  <div class="absolute -bottom-16 -right-10 h-48 w-48 rounded-full blur-3xl opacity-40"
       style="background: linear-gradient(120deg, rgba(16,185,129,0.35), rgba(59,130,246,0.35));"></div>
</section>

<!-- Cards -->
<div id="cardsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
  {% for s in sections %}
  <a href="{{ s.href }}"
     class="group card block rounded-2xl border bg-white p-4 shadow-sm transition
            hover:-translate-y-0.5 hover:shadow-md dark:bg-gray-900 dark:border-gray-700"
     data-title="{{ s.title|lower }} {{ s.summary|lower }}">
    <div class="flex items-start justify-between gap-3">
      <div class="flex items-center gap-2">
        <!-- Icon by id -->
        <div class="h-9 w-9 rounded-xl grid place-items-center
                    bg-gradient-to-br from-indigo-500 to-purple-500 text-white text-lg shadow-sm">
          {% if s.id == 'intro' %}ğŸ“˜{% elif s.id == 'process' %}ğŸ› ï¸{% elif s.id == 'mindmap' %}ğŸ§ {% elif s.id=='theory' %}ğŸ“š{% else %}âœ¨{% endif %}
        </div>
        <h2 class="text-lg font-semibold">{{ s.title }}</h2>
      </div>
      <!-- Shortcut badge -->
      <span class="text-[11px] text-gray-500 border rounded-full px-2 py-0.5">Key {{ loop.index }}</span>
    </div>
    <p class="mt-2 text-gray-600 line-clamp-2 dark:text-gray-300">{{ s.summary }}</p>
    <div class="mt-3 flex items-center gap-2 text-sm">
      <span class="text-indigo-600 group-hover:underline">Open</span>
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transition-transform group-hover:translate-x-0.5"
           viewBox="0 0 20 20" fill="currentColor">
        <path d="M12.293 3.293a1 1 0 011.414 0L18 7.586a1 1 0 010 1.414l-4.293 4.293a1 1 0 01-1.414-1.414L14.586 9H5a1 1 0 110-2h9.586l-2.293-2.293a1 1 0 010-1.414z"/>
      </svg>
    </div>
  </a>
  {% endfor %}
</div>

<!-- Extra: Quick links row -->
<div class="mt-6 grid grid-cols-1 sm:grid-cols-3 gap-3">
  <a href="{{ url_for('process') }}" class="block rounded-xl border p-3 hover:bg-gray-50 dark:hover:bg-gray-800 dark:border-gray-700">
    <div class="text-sm font-semibold">ğŸš€ Start with the hands-on Process</div>
    <div class="text-xs text-gray-600 dark:text-gray-400">End-to-end skeleton with one-line code hints</div>
  </a>
  <a href="{{ url_for('theory') }}" class="block rounded-xl border p-3 hover:bg-gray-50 dark:hover:bg-gray-800 dark:border-gray-700">
    <div class="text-sm font-semibold">ğŸ“š Data Prep Theory</div>
    <div class="text-xs text-gray-600 dark:text-gray-400">Cleaning, preprocessing, feature engineering</div>
  </a>
  <a href="{{ url_for('mindmap') }}" class="block rounded-xl border p-3 hover:bg-gray-50 dark:hover:bg-gray-800 dark:border-gray-700">
    <div class="text-sm font-semibold">ğŸ§  Interactive Mind Map</div>
    <div class="text-xs text-gray-600 dark:text-gray-400">Models, parameters, search & voice</div>
  </a>
</div>

<!-- Page scripts -->
<script>
  // --- Dark mode toggle (persists) ---
  (function () {
    const root = document.documentElement;
    const saved = localStorage.getItem('theme'); // 'dark' | 'light' | null
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    if (saved ? saved === 'dark' : prefersDark) root.classList.add('dark');

    document.getElementById('themeToggle')?.addEventListener('click', () => {
      root.classList.toggle('dark');
      const isDark = root.classList.contains('dark');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });
  })();

  // --- Search filter + Cmd/Ctrl+K focus ---
  (function () {
    const input = document.getElementById('searchInput');
    const grid = document.getElementById('cardsGrid');
    const cards = Array.from(grid.querySelectorAll('.card'));

    function applyFilter() {
      const q = (input.value || '').trim().toLowerCase();
      cards.forEach(c => {
        const hay = c.getAttribute('data-title') || '';
        c.style.display = hay.includes(q) ? '' : 'none';
      });
    }

    input?.addEventListener('input', applyFilter);
    window.addEventListener('keydown', (e) => {
      if ((e.metaKey || e.ctrlKey) && e.key.toLowerCase() === 'k') {
        e.preventDefault(); input?.focus();
      }
    });
  })();

  // --- Keyboard shortcuts 1..9 open cards ---
  (function () {
    const grid = document.getElementById('cardsGrid');
    const links = Array.from(grid.querySelectorAll('a.card'));
    window.addEventListener('keydown', (e) => {
      if (document.activeElement && ['INPUT', 'TEXTAREA'].includes(document.activeElement.tagName)) return;
      const n = parseInt(e.key, 10);
      if (!isNaN(n) && n >= 1 && n <= links.length) {
        links[n - 1].click();
      }
    });
  })();

  // --- Subtle 3D hover tilt for cards (no lib) ---
  (function () {
    const cards = document.querySelectorAll('a.card');
    cards.forEach(card => {
      const r = 10; // max rotation deg
      card.addEventListener('mousemove', (e) => {
        const rect = card.getBoundingClientRect();
        const x = (e.clientX - rect.left) / rect.width;
        const y = (e.clientY - rect.top) / rect.height;
        const rx = (0.5 - y) * r;
        const ry = (x - 0.5) * r;
        card.style.transform = `perspective(800px) rotateX(${rx}deg) rotateY(${ry}deg) translateY(-2px)`;
      });
      ['mouseleave','blur'].forEach(evt =>
        card.addEventListener(evt, () => card.style.transform = 'translateY(-2px)'));
    });
  })();
</script>
{% endblock %}
